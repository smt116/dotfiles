#!/usr/bin/env sh

# Add ticket id to commit message as [#TICKET-ID]. Requires ticket-id/description format of current branch name.

BRANCH=$(git symbolic-ref --short HEAD)
TICKET_ID=${BRANCH%/*}

if [ "$BRANCH"  == "$TICKET_ID" ]; then exit 0; fi

grep --no-messages --silent "^\[#.*\]" $1
if [ $? -eq 0 ]; then exit 0; fi

sed --in-place --expression "1i\[#$TICKET_ID\]" $1
